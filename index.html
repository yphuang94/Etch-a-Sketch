<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Etch-a-Sketch</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div id="main-container">
        <div id="user-container">
            <div><input type="range" min="1" max="32" value="16" id="slider">
            <p>Grid Size: <span id="gridsize"></span></p>
            </div>
            <div id="clear-grid"><button onclick="clearGrid()">CLEAR PLACEHOLDER</button></div>
        </div>
        <div id="grid-container" onmousemove="colorGrid()"></div>
    </div>
    

    <script>

        var slider = document.getElementById("slider"); 
        var output = document.getElementById("gridsize"); 

        output.innerHTML = slider.value; 
        
        slider.oninput = function() { 
            output.innerHTML = slider.value; 
        }
        
        slider.onmouseup = function() {
            output.innerHTML = slider.value;
            newGrid();
        }

        createGrid();

        function resetGrid() {
            let parent = document.getElementById("grid-container") 
            while (parent.hasChildNodes()) {
                parent.removeChild(parent.firstChild);
            }
        }

        function createGrid() {
            for (i = 0; i < slider.value; i++) { 
                let new_container = document.getElementById("grid-container").appendChild(document.createElement('div'));
                new_container.classList.add("grid");
            }
            
            const boxes = document.querySelectorAll(".grid")

            boxes.forEach(box => {
            box.addEventListener("mousedown", function(){
                box.style.backgroundColor = `#D3D3D3`;
            })
        })
        }

        function newGrid() {
            resetGrid();
            createGrid();
        }

        var mouseToggle = false;
        let pos = "";

        document.addEventListener("mousedown", function (){
            mouseToggle = true;
        })
        document.addEventListener("mouseup", function (){
            mouseToggle = false;
        })
        
        document.addEventListener("mousemove", ({pageX, pageY}) => {
            pos = `${pageX},${pageY}`;
        });
        
        function colorGrid() {
            let posX = pos.slice(0,3);
            let posY = pos.slice(-3);
            if(mouseToggle == true){
                document.elementFromPoint(posX,posY).style.backgroundColor = `#D3D3D3`;
            }
        }

        /*
        const boxes = document.querySelectorAll(".grid")
        
        boxes.forEach(box => {
            box.addEventListener("mousedown", function(){
                box.style.backgroundColor = `#D3D3D3`;
            })
        })
        */
        function clearGrid() {
            boxes.forEach(box => {
                box.style.backgroundColor = `#FFFFFF`;
            })
        }
        
    </script>

</body>
</html>